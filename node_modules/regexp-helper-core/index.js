"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.REGEXP_TO_STRING_TAG = Object.prototype.toString.call(/a/);
function toHex(n, toUpperCase) {
    let s = n.toString(16).padStart(4, '0');
    return toUpperCase ? s.toUpperCase() : s;
}
exports.toHex = toHex;
/**
 * @code
 * console.log(core.toUnicode('𠮷')); // => \u{20bb7}
 * console.log(core.toUnicode('𠮷'.codePointAt(0)));
 *
 * console.log(core.toUnicode('𠮷', true)); // => \ud842\udfb7
 * console.log(core.toUnicode('𠮷'.codePointAt(0), true));
 *
 * /[𠮷]/u.test('𠮷')
 * /[\u{20bb7}]/u.test('𠮷')
 * /[\ud842\udfb7]/u.test('𠮷')
 */
function toUnicode(charCode, noMerge, wrap) {
    let s;
    if (typeof charCode == 'string') {
        s = charCode;
        charCode = s.codePointAt(0);
    }
    if (charCode > 0xffff && noMerge) {
        let p;
        if (typeof s != 'string') {
            //s = String.fromCodePoint(charCode);
            p = surrogatePair(charCode);
        }
        else {
            p = [s.charCodeAt(0), s.charCodeAt(1)];
        }
        return p.map(function (n) {
            return _toUnicode(n, wrap);
        }).join('');
    }
    return _toUnicode(charCode, wrap);
}
exports.toUnicode = toUnicode;
function _toUnicode(charCode, wrap) {
    let hex = toHex(charCode);
    return (wrap || hex.length > 4) ? `\\u{${hex}}` : `\\u${hex}`;
}
exports._toUnicode = _toUnicode;
function isDoubleUnicode(str) {
    return str.charCodeAt(0) == str.codePointAt(0);
}
exports.isDoubleUnicode = isDoubleUnicode;
function isRegExp(r) {
    if ((r instanceof RegExp) || Object.prototype.toString.call(r) === exports.REGEXP_TO_STRING_TAG) {
        return r;
    }
    return null;
}
exports.isRegExp = isRegExp;
/**
 * @link https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae
 * @link https://github.com/ikatyang/regexp-util/blob/7810ce61ff8becd728b745eb6d5c1ca76adfebe0/src/charset.ts#L289
 *
 * @code
 * surrogatePair('𠮷'.codePointAt(0)) // => { h: 55362, l: 57271 }
 * console.log('𠮷'.charCodeAt(0), '𠮷'.charCodeAt(1)) // => 55362 57271
 */
function surrogatePair(codepoint) {
    let h = Math.floor((codepoint - 0x10000) / 0x400) + 0xd800;
    let l = (codepoint - 0x10000) % 0x400 + 0xdc00;
    return Object.assign([h, l], {
        h,
        l,
    });
}
exports.surrogatePair = surrogatePair;
/**
 * https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae
 *
 * @code
 * unicodeUnEscape('\\u{48}\\u{65}\\u{6c}\\u{6c}\\u{6f}\\u{20}\\u{77}\\u{6f}\\u{72}\\u{6c}\\u{64}') // => 'Hello world'
 * unicodeUnEscape('\\u{20bb7}') // => '𠮷'
 */
function unicodeUnEscape(string, noLeadingSolidus) {
    // note: this will match `u{123}` (no leading `\`) as well
    const r = noLeadingSolidus ? /u\{([0-9a-fA-F]{1,8})\}/g : /\\u\{([0-9a-fA-F]{1,8})\}/g;
    return string.replace(r, function ($0, $1) {
        return String.fromCodePoint(parseInt($1, 16));
    });
}
exports.unicodeUnEscape = unicodeUnEscape;
/**
 * @code
 * unicodeEscape('𠮷') // => '\\u{20bb7}'
 */
function unicodeEscape(string, noLeadingSolidus, noMerge, noWrap, filter = /./ug) {
    return string.replace(filter, function ($0, $1) {
        let s = toUnicode($0, noMerge, !noWrap);
        return noLeadingSolidus ? s.replace(/\\/, '') : s;
    });
}
exports.unicodeEscape = unicodeEscape;
function escapeRegExp(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}
exports.escapeRegExp = escapeRegExp;
exports.default = exports;
Object.freeze(exports);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFhLFFBQUEsb0JBQW9CLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBVyxDQUFDO0FBRWxGLFNBQWdCLEtBQUssQ0FBQyxDQUFTLEVBQUUsV0FBcUI7SUFFckQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLE9BQU8sV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMxQyxDQUFDO0FBSkQsc0JBSUM7QUFFRDs7Ozs7Ozs7Ozs7R0FXRztBQUNILFNBQWdCLFNBQVMsQ0FBQyxRQUF5QixFQUFFLE9BQWlCLEVBQUUsSUFBYztJQUVyRixJQUFJLENBQVMsQ0FBQztJQUVkLElBQUksT0FBTyxRQUFRLElBQUksUUFBUSxFQUMvQjtRQUNDLENBQUMsR0FBRyxRQUFRLENBQUM7UUFDYixRQUFRLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUM1QjtJQUVELElBQUksUUFBUSxHQUFHLE1BQU0sSUFBSSxPQUFPLEVBQ2hDO1FBQ0MsSUFBSSxDQUFXLENBQUM7UUFFaEIsSUFBSSxPQUFPLENBQUMsSUFBSSxRQUFRLEVBQ3hCO1lBQ0MscUNBQXFDO1lBQ3JDLENBQUMsR0FBRyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDNUI7YUFFRDtZQUNDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3ZDO1FBRUQsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLFVB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cUJBQXFCLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDbkQsQ0FBQztBQUhELG9DQUdDO0FBRUQsa0JBQWUsT0FBNkMsQ0FBQTtBQUU1RCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IFJFR0VYUF9UT19TVFJJTkdfVEFHID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKC9hLykgYXMgc3RyaW5nO1xuXG5leHBvcnQgZnVuY3Rpb24gdG9IZXgobjogbnVtYmVyLCB0b1VwcGVyQ2FzZT86IGJvb2xlYW4pXG57XG5cdGxldCBzID0gbi50b1N0cmluZygxNikucGFkU3RhcnQoNCwgJzAnKTtcblx0cmV0dXJuIHRvVXBwZXJDYXNlID8gcy50b1VwcGVyQ2FzZSgpIDogcztcbn1cblxuLyoqXG4gKiBAY29kZVxuICogY29uc29sZS5sb2coY29yZS50b1VuaWNvZGUoJ/CgrrcnKSk7IC8vID0+IFxcdXsyMGJiN31cbiAqIGNvbnNvbGUubG9nKGNvcmUudG9Vbmljb2RlKCfwoK63Jy5jb2RlUG9pbnRBdCgwKSkpO1xuICpcbiAqIGNvbnNvbGUubG9nKGNvcmUudG9Vbmljb2RlKCfwoK63JywgdHJ1ZSkpOyAvLyA9PiBcXHVkODQyXFx1ZGZiN1xuICogY29uc29sZS5sb2coY29yZS50b1VuaWNvZGUoJ/CgrrcnLmNvZGVQb2ludEF0KDApLCB0cnVlKSk7XG4gKlxuICogL1vwoK63XS91LnRlc3QoJ/CgrrcnKVxuICogL1tcXHV7MjBiYjd9XS91LnRlc3QoJ/CgrrcnKVxuICogL1tcXHVkODQyXFx1ZGZiN10vdS50ZXN0KCfwoK63JylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvVW5pY29kZShjaGFyQ29kZTogbnVtYmVyIHwgc3RyaW5nLCBub01lcmdlPzogYm9vbGVhbiwgd3JhcD86IGJvb2xlYW4pXG57XG5cdGxldCBzOiBzdHJpbmc7XG5cblx0aWYgKHR5cGVvZiBjaGFyQ29kZSA9PSAnc3RyaW5nJylcblx0e1xuXHRcdHMgPSBjaGFyQ29kZTtcblx0XHRjaGFyQ29kZSA9IHMuY29kZVBvaW50QXQoMCk7XG5cdH1cblxuXHRpZiAoY2hhckNvZGUgPiAweGZmZmYgJiYgbm9NZXJnZSlcblx0e1xuXHRcdGxldCBwOiBudW1iZXJbXTtcblxuXHRcdGlmICh0eXBlb2YgcyAhPSAnc3RyaW5nJylcblx0XHR7XG5cdFx0XHQvL3MgPSBTdHJpbmcuZnJvbUNvZGVQb2ludChjaGFyQ29kZSk7XG5cdFx0XHRwID0gc3Vycm9nYXRlUGFpcihjaGFyQ29kZSk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHRwID0gW3MuY2hhckNvZGVBdCgwKSwgcy5jaGFyQ29kZUF0KDEpXTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcC5tYXAoZnVuY3Rpb24gKG4pXG5cdFx0e1xuXHRcdFx0cmV0dXJuIF90b1VuaWNvZGUobiwgd3JhcCk7XG5cdFx0fSkuam9pbignJyk7XG5cdH1cblxuXHRyZXR1cm4gX3RvVW5pY29kZShjaGFyQ29kZSwgd3JhcCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfdG9Vbmljb2RlKGNoYXJDb2RlOiBudW1iZXIsIHdyYXA/OiBib29sZWFuKVxue1xuXHRsZXQgaGV4ID0gdG9IZXgoY2hhckNvZGUpO1xuXHRyZXR1cm4gKHdyYXAgfHwgaGV4Lmxlbmd0aCA+IDQpID8gYFxcXFx1eyR7aGV4fX1gIDogYFxcXFx1JHtoZXh9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRG91YmxlVW5pY29kZShzdHI6IHN0cmluZylcbntcblx0cmV0dXJuIHN0ci5jaGFyQ29kZUF0KDApID09IHN0ci5jb2RlUG9pbnRBdCgwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUmVnRXhwPFQgZXh0ZW5kcyBSZWdFeHA+KHI6IFQpOiBUICYgUmVnRXhwXG5leHBvcnQgZnVuY3Rpb24gaXNSZWdFeHAocjogUmVnRXhwKTogciBpcyBSZWdFeHBcbmV4cG9ydCBmdW5jdGlvbiBpc1JlZ0V4cChyKTogUmVnRXhwIHwgbnVsbFxuZXhwb3J0IGZ1bmN0aW9uIGlzUmVnRXhwKHIpXG57XG5cdGlmICgociBpbnN0YW5jZW9mIFJlZ0V4cCkgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHIpID09PSBSRUdFWFBfVE9fU1RSSU5HX1RBRylcblx0e1xuXHRcdHJldHVybiByO1xuXHR9XG5cblx0cmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogQGxpbmsgaHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtZW5jb2Rpbmcjc3Vycm9nYXRlLWZvcm11bGFlXG4gKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vaWthdHlhbmcvcmVnZXhwLXV0aWwvYmxvYi83ODEwY2U2MWZmOGJlY2Q3MjhiNzQ1ZWI2ZDVjMWNhNzZhZGZlYmUwL3NyYy9jaGFyc2V0LnRzI0wyODlcbiAqXG4gKiBAY29kZVxuICogc3Vycm9nYXRlUGFpcign8KCutycuY29kZVBvaW50QXQoMCkpIC8vID0+IHsgaDogNTUzNjIsIGw6IDU3MjcxIH1cbiAqIGNvbnNvbGUubG9nKCfwoK63Jy5jaGFyQ29kZUF0KDApLCAn8KCutycuY2hhckNvZGVBdCgxKSkgLy8gPT4gNTUzNjIgNTcyNzFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN1cnJvZ2F0ZVBhaXIoY29kZXBvaW50OiBudW1iZXIpXG57XG5cdGxldCBoID0gTWF0aC5mbG9vcigoY29kZXBvaW50IC0gMHgxMDAwMCkgLyAweDQwMCkgKyAweGQ4MDA7XG5cdGxldCBsID0gKGNvZGVwb2ludCAtIDB4MTAwMDApICUgMHg0MDAgKyAweGRjMDA7XG5cblx0cmV0dXJuIE9iamVjdC5hc3NpZ24oW2gsIGxdIGFzIFtudW1iZXIsIG51bWJlcl0sIHtcblx0XHRoLFxuXHRcdGwsXG5cdH0pO1xufVxuXG4vKipcbiAqIGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nI3N1cnJvZ2F0ZS1mb3JtdWxhZVxuICpcbiAqIEBjb2RlXG4gKiB1bmljb2RlVW5Fc2NhcGUoJ1xcXFx1ezQ4fVxcXFx1ezY1fVxcXFx1ezZjfVxcXFx1ezZjfVxcXFx1ezZmfVxcXFx1ezIwfVxcXFx1ezc3fVxcXFx1ezZmfVxcXFx1ezcyfVxcXFx1ezZjfVxcXFx1ezY0fScpIC8vID0+ICdIZWxsbyB3b3JsZCdcbiAqIHVuaWNvZGVVbkVzY2FwZSgnXFxcXHV7MjBiYjd9JykgLy8gPT4gJ/CgrrcnXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bmljb2RlVW5Fc2NhcGUoc3RyaW5nOiBzdHJpbmcsIG5vTGVhZGluZ1NvbGlkdXM/OiBib29sZWFuKVxue1xuXHQvLyBub3RlOiB0aGlzIHdpbGwgbWF0Y2ggYHV7MTIzfWAgKG5vIGxlYWRpbmcgYFxcYCkgYXMgd2VsbFxuXHRjb25zdCByID0gbm9MZWFkaW5nU29saWR1cyA/IC91XFx7KFswLTlhLWZBLUZdezEsOH0pXFx9L2cgOiAvXFxcXHVcXHsoWzAtOWEtZkEtRl17MSw4fSlcXH0vZztcblxuXHRyZXR1cm4gc3RyaW5nLnJlcGxhY2UociwgZnVuY3Rpb24gKCQwLCAkMSlcblx0e1xuXHRcdHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChwYXJzZUludCgkMSwgMTYpKTtcblx0fSk7XG59XG5cbi8qKlxuICogQGNvZGVcbiAqIHVuaWNvZGVFc2NhcGUoJ/CgrrcnKSAvLyA9PiAnXFxcXHV7MjBiYjd9J1xuICovXG5leHBvcnQgZnVuY3Rpb24gdW5pY29kZUVzY2FwZShzdHJpbmc6IHN0cmluZyxcblx0bm9MZWFkaW5nU29saWR1cz86IGJvb2xlYW4sXG5cdG5vTWVyZ2U/OiBib29sZWFuLFxuXHRub1dyYXA/OiBib29sZWFuLFxuXHRmaWx0ZXIgPSAvLi91Z1xuKVxue1xuXHRyZXR1cm4gc3RyaW5nLnJlcGxhY2UoZmlsdGVyLCBmdW5jdGlvbiAoJDAsICQxKVxuXHR7XG5cdFx0bGV0IHMgPSB0b1VuaWNvZGUoJDAsIG5vTWVyZ2UsICFub1dyYXApO1xuXG5cdFx0cmV0dXJuIG5vTGVhZGluZ1NvbGlkdXMgPyBzLnJlcGxhY2UoL1xcXFwvLCAnJykgOiBzO1xuXHR9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHI6IHN0cmluZylcbntcblx0cmV0dXJuIHN0ci5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBleHBvcnRzIGFzIFJlYWRvbmx5PHR5cGVvZiBpbXBvcnQoJy4vaW5kZXgnKT5cblxuT2JqZWN0LmZyZWV6ZShleHBvcnRzKTtcbiJdfQ==